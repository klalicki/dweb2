---
import { getCollection } from "astro:content";
import { Marp } from "@marp-team/marp-core";

const { slug } = Astro.params;
export async function getStaticPaths() {
  const slides = await getCollection("slides");
  return slides.map((slide) => {
    return { params: { slug: slide.id.split("/")[0] } };
  });
}

const pageData = await getCollection("slides");
const globbedFiles = Object.values(
  import.meta.glob(`/src/content/classes/*/slides.md`, {
    eager: true,
  })
);

console.log(globbedFiles);

const targetData = pageData.find((slide) => {
  // console.log(slide);
  return slide.id.split("/")[0] == slug;
});
const marp = new Marp({
  script: {
    source: "cdn",
  },
});
const mdData = targetData?.body;
const { html, css } = marp.render(mdData);
const marpTotal = marp.render(mdData);
const marpKeys = Object.keys(marpTotal);
---

<!-- {JSON.stringify(marpKeys)} -->
<Fragment set:html={html} />
<style set:html={css}></style>
