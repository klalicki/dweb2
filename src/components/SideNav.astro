---
import { getCollection } from "astro:content";

const lessons = await getCollection("lessons");
const projects = await getCollection("projects");
---

<nav class:list={["menu-main", "menu-switchable"]}>
  <button id="menu-toggle" class="btn"
    ><span class="menu-toggle-text">Menu</span></button
  >
  <div class="menu-main-group menu-mobile-hidden">
    <button id="menu-close" class="btn">
      <span class="menu-toggle-text">Close</span></button
    >
    <h2>Classes</h2>
    {
      lessons.map((classItem) => (
        <a href={`/classes/${classItem.id}/lesson`}>{classItem.data.title}</a>
      ))
    }
    <h2>Projects</h2>
    {
      projects.map((projectItem) => (
        <a href={`/projects/${projectItem.id}`}>{projectItem.data.title}</a>
      ))
    }
    <h2>Resources</h2>
  </div>
</nav>

<style>
  nav {
    display: flex;
    flex-direction: column;
    padding: 1rem;
    outline: 1px solid white;
  }
  a {
    padding: 0.5rem 0;
  }
  .menu-main-group {
    position: fixed;
    top: 0px;
    left: 0px;
    right: 0px;
    height: 100%;
    overflow-y: auto;
    padding: 1rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;

    overflow-y: auto;
    z-index: 1000;
    transform: none;
    transition: all 0.3s;
    backdrop-filter: blur(20px);
  }
  .menu-mobile-hidden {
    transform: translateY(-50px);
    /* overflow: hidden; */
    opacity: 0;
    pointer-events: none;
    transition: all 0.3s;
  }

  #menu-close {
    font-size: 1.5rem;
    z-index: 1000;
    position: absolute;
    right: 1rem;
    top: 1rem;
  }

  @media screen and (min-width: 768px) {
    nav {
      position: fixed;
      left: 0;
      top: 0;
      height: 100vh;
      overflow-y: auto;
      width: var(--size-sidenav-width);
    }
    .menu-main-group.menu-main-group {
      opacity: 1;
      transform: none;
      position: static;
      pointer-events: auto;
    }
    #menu-toggle,
    #menu-close {
      display: none;
    }
  }
</style>

<script type="text/javascript">
  const hideMobileMenu = () => {
    document
      .querySelector(".menu-main-group")
      ?.classList.toggle("menu-mobile-hidden", true);
  };

  document.querySelector("#menu-toggle")?.addEventListener("click", () => {
    document
      .querySelector(".menu-main-group")
      ?.classList.toggle("menu-mobile-hidden");
  });

  document.querySelector("#menu-close")?.addEventListener("click", (e) => {
    e.preventDefault();
    hideMobileMenu();
  });
</script>
